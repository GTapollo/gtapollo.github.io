---
layout: default
nav: blog
---

<link rel="stylesheet" href="/assets/css/markdown.css">

<style>
.icon-button{
  color: black!important;
  text-decoration: none!important;
}
.fixed-header{
  position: fixed;
  right: 0;
  left: 0;
  padding-top: 5px;
  background: rgba(255, 255, 255, 0.9);
  box-shadow: inset 0 -1px 0 white, 0 1px 5px rgba(0,0,0,.3);
}
.fixed-header .page-header{
  border-bottom: 0;
  margin-bottom: 0px;
}
#page-content{
  margin-top: 90px;
  margin-bottom: 15px;
}
#post-toc{
  background:#f5f5f5;
  padding:15px;
}
#post-toc .header{
  margin:0;
}
#post-toc .content>ol{
  margin: 10px 0 0 0;
}
#post-toc ul{
  margin-top:5px;
}
#post-toc ul, #post-toc li{
  margin-top:5px;
}
#post-content{
  margin-top:15px;
}
</style>

<div class="fixed-header">
  <div class="page-header container">
    <h1>{{ page.title }}</h1>
    <div>
      {% for cat in page.categories %}
      <span class="label label-info">{{ cat }}</span>
      {% endfor %}
      {% for tag in page.tags %}
      <span class="label label-success">{{ tag }}</span>
      {% endfor %}
      <a class="pull-right label label-darkgrey" href="/blog.html" style="margin-left: 10px;">
          返回列表
      </a>
      <span class="pull-right label label-default">
          {{ page.date | date: "%Y年%m月%d日" }}
      </span>
    </div>
  </div>
</div>

<div class="container">
  
  <div id="page-content">
    <div id="post-toc"></div>
    
    <div id="post-content" class="md">
      {{ content }}
    </div>
  </div>

  <!-- UY BEGIN -->
  <div id="uyan_frame"></div>
  <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1851884"></script>
  <!-- UY END -->
  
  <script>
    $(function(){
      $('#post-toc').html(genTOC($('#post-content')));
      
      $('#toc_icon').click(function(){
        $('#post-toc .content').toggle(400);
        $(this).toggleClass('glyphicon-chevron-up glyphicon-chevron-down');
      });
    })
    
    // add toc for html content
    function genTOC($content) {
      var toc = $('<ol/>');
      var ul = '';
  
      var fi = 1;
      while ($content.find('h' + fi).length < 1 && fi < 7) fi += 1;
      if (fi == 7) return "";
      
      var c = ['H' + fi,'H' + (fi+1),'H' + (fi+2)];
      $content.find('h' + fi + ',h' + (fi + 1) + ',h' + (fi + 2)).each(function (i) {
        var $this = $(this);
        $this.attr('id', i);
        if (this.nodeName == c[0]) {
          var li = new $('<li/>')
            .append('<a href="#' + i + '" offset="100" class="animate">' + $this.text() + '</a>')
            .append($('<ul/>'));
          toc.append(li);
        }
        else if(this.nodeName == c[1]){
          var li = new $('<li/>')
            .append('<a href="#' + i + '" offset="100" class="animate">' + $this.text() + '</a>')
            .append($('<ul/>'));
          toc.find('a[href="#'+$this.prevAll(c[0]).first().attr('id')+'"]')
                   .next('ul').append(li);
        }
        else{ 
          var li = new $('<li/>')
            .append('<a href="#' + i + '" offset="100" class="animate">' + $this.text() + '</a>')
            .append($('<ul/>'));
          toc.find('a[href="#'+$this.prevAll(c[1]).first().attr('id')+'"]')
                   .next('ul').append(li);
        }
      });
      return '<h4 class="header" style="display:inline;">目录</h4>'
        + '<span id="toc_icon" class="glyphicon glyphicon-chevron-up" style="margin-left:5px;cursor:pointer;"></span>'
        + '<div class="content">' + toc[0].outerHTML + '</div>';
    }
  </script>
</div>
